import{M as C}from"./bootstrap.esm-DIo4p9UB.js";import{_ as y,o as i,c as n,b as t,t as d,e as _,f as k,v as x,g as p,a as m,F as T,h as $,r as h,n as g}from"./index-DpuNeIf4.js";const A={data(){return{productModal:null,modalQty:1}},props:["product"],mounted(){this.productModal=new C(this.$refs.modal)},methods:{open(){this.modalQty=1,this.productModal.show()},close(){this.productModal.hide()},addToCart(o,a){this.$emit("emit-modalQty",o,a)}}},U={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},E={class:"modal-dialog modal-xl",role:"document"},P={class:"modal-content border-0"},V={class:"modal-header bg-dark text-white"},L={class:"modal-title",id:"exampleModalLabel"},Q=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),w={class:"modal-body"},D={class:"row"},R={class:"col-sm-6"},S=["src"],B={class:"col-sm-6"},I={class:"badge bg-primary rounded-pill"},N={key:0,class:"h6"},q={class:"h5"},z={class:"input-group"};function F(o,a,e,r,s,c){return i(),n("div",U,[t("div",E,[t("div",P,[t("div",V,[t("h5",L,[t("span",null,d(e.product.title),1)]),Q]),t("div",w,[t("div",D,[t("div",R,[t("img",{class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,S)]),t("div",B,[t("span",I,d(),1),t("p",null,"商品描述："+d(e.product.description),1),t("p",null,"商品內容："+d(e.product.content),1),e.product.origin_price!=e.product.price?(i(),n("del",N,"原價 "+d(e.product.origin_price)+" 元",1)):_("",!0),t("div",q,"現在只要 "+d(e.product.price)+" 元",1),t("div",null,[t("div",z,[k(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":a[0]||(a[0]=u=>s.modalQty=u)},null,512),[[x,s.modalQty]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=u=>c.addToCart(e.product.id,s.modalQty))},"加入購物車")])])])])])])])],512)}const H=y(A,[["render",F]]);var O={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gobobofu",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:b,VITE_PATH:v}=O,j={data(){return{products:[],carts:{},tempProduct:{},productModal:null,isLoading:!0,isUpdating:!0,isCartAdded:!1,cartAddedMessage:"",qty:1,orderData:{data:{user:{name:"test",email:"test@gmail.com",tel:"0912346768",address:"kaohsiung"},message:"這是留言"}}}},components:{UserProductModal:H},methods:{openModal(o){this.tempProduct=o,this.$refs.userModal.open()},addToCart(o,a=1){const e={data:{product_id:o,qty:Number(a)}};this.isUpdating=!0,p.post(`${b}/api/${v}/cart`,e).then(r=>{console.log(r),this.isUpdating=!1,this.cartAddedMessage=`${r.data.data.product.title}加入購物車成功。`,this.isCartAdded=!0,setTimeout(()=>{this.isCartAdded=!1},3e3),this.$refs.userModal.close()}).catch(r=>{console.dir(r)})},getAllProducts(){p.get(`${b}/api/${v}/products/all`).then(o=>{this.isLoading=!1,this.isUpdating=!1,this.products=o.data.products}).catch(o=>{console.dir(o)})}},mounted(){this.getAllProducts()}},G={id:"app"},J={class:"container"},K={class:"mt-4"},W={key:0,class:"alert alert-primary position-fixed",role:"alert"},X={class:"table align-middle"},Y=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),Z={style:{width:"200px"}},tt={key:0,class:"h6"},et={class:"h5"},ot={class:"btn-group btn-group-sm"},st=["onClick"],dt=["onClick"];function at(o,a,e,r,s,c){const u=h("loading-overlay"),f=h("user-product-modal");return i(),n("div",G,[m(u,{active:s.isLoading},null,8,["active"]),m(f,{product:s.tempProduct,ref:"userModal",onEmitModalQty:c.addToCart},null,8,["product","onEmitModalQty"]),t("div",J,[t("div",K,[s.isCartAdded?(i(),n("div",W,d(s.cartAddedMessage),1)):_("",!0),t("table",X,[Y,t("tbody",null,[(i(!0),n(T,null,$(s.products,l=>(i(),n("tr",{key:l.id},[t("td",Z,[t("div",{style:g([{height:"100px","background-size":"cover","background-position":"center"},{"background-image":`url(${l.imageUrl})`}])},null,4)]),t("td",null,d(l.title),1),t("td",null,[l.origin_price!=l.price?(i(),n("del",tt,"原價 "+d(l.origin_price)+" 元",1)):_("",!0),t("div",et,"現在只要 "+d(l.price)+" 元",1)]),t("td",null,[t("div",ot,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:M=>c.openModal(l)}," 查看更多 ",8,st),t("i",{class:"fas fa-spinner fa-pulse",style:g({opacity:s.isUpdating?"1":"0"})},null,4),t("button",{type:"button",class:"btn btn-outline-danger",onClick:M=>c.addToCart(l.id)}," 加到購物車 ",8,dt)])])]))),128))])])])])])}const nt=y(j,[["render",at]]);export{nt as default};
